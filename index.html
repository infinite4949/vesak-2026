<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Vesak Global Lighting | è¡›å¡å…¨çƒé»ç‡ˆ</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --gold: #ffd700;
            --deep-blue: #0a192f;
            --text-light: #e6f1ff;
        }

        body, html {
            margin: 0; padding: 0; height: 100%;
            background-color: var(--deep-blue);
            color: var(--text-light);
            font-family: 'Noto Serif TC', serif;
            overflow-x: hidden;
        }

        /* èƒŒæ™¯æ˜Ÿç©ºç‰¹æ•ˆ */
        #stars-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #112240 0%, #0a192f 100%);
            z-index: -1;
        }

        /* å°è¦½åˆ— */
        nav {
            position: fixed; top: 0; width: 100%; padding: 20px;
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(10, 25, 47, 0.85); backdrop-filter: blur(10px);
            z-index: 1000; box-sizing: border-box;
        }

        .lang-btn {
            background: transparent; border: 1px solid var(--gold);
            color: var(--gold); padding: 8px 16px; cursor: pointer;
            border-radius: 20px; transition: 0.3s;
        }

        .lang-btn:hover { background: var(--gold); color: var(--deep-blue); }

        /* ä¸»è¦–è¦ºå€ */
        .hero {
            text-align: center; padding: 120px 20px 40px;
        }

        .buddha-img {
            max-width: 300px; width: 80%; border-radius: 50%;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
            margin-bottom: 20px;
        }

        /* è“®èŠ±å‘¼å¸ç‡ˆå‹•ç•« */
        @keyframes breathe {
            0% { transform: scale(1); opacity: 0.8; filter: drop-shadow(0 0 5px gold); }
            50% { transform: scale(1.4); opacity: 1; filter: drop-shadow(0 0 20px gold); }
            100% { transform: scale(1); opacity: 0.8; filter: drop-shadow(0 0 5px gold); }
        }

        .lotus-icon {
            font-size: 30px !important; /* åŠ å¤§è“®èŠ± */
            text-align: center;
            line-height: 1;
            cursor: pointer;
            z-index: 1000 !important; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
            animation: breathe 2s infinite ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
            background: none !important;
            border: none !important;
        }

        /* åœ°åœ–å€åŸŸ */
        #map {
            height: 500px; width: 90%; max-width: 1000px;
            margin: 20px auto; border: 2px solid var(--gold);
            border-radius: 15px; box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }

        .stats-badge {
            background: rgba(255, 215, 0, 0.1); border: 1px solid var(--gold);
            padding: 15px 30px; border-radius: 50px; display: inline-block;
            margin-top: 20px; font-size: 1.2em; color: var(--gold);
        }

        /* å½ˆçª—æ¨£å¼ */
        .leaflet-popup-content-wrapper {
            background: #112240; color: white; border: 1px solid var(--gold);
        }
        .leaflet-popup-tip { background: var(--gold); }
    </style>
</head>
<body>

<div id="stars-container"></div>

<nav>
    <div id="nav-title" style="font-weight: bold; font-size: 1.2em; color: var(--gold);">
        VESAK GLOBAL LIGHTING | è¡›å¡å…¨çƒé»ç‡ˆ
    </div>
    <button class="lang-btn" onclick="toggleLang()">EN / ä¸­æ–‡</button>
</nav>

<div class="hero">
    <img src="buddha_vesak.png" alt="Buddha" class="buddha-img">
    <h2 id="quote-text">ã€Œé¡˜æ…ˆæ‚²ä¹‹å…‰ï¼Œç…§ç ´ä¸–é–“é»‘æš—ã€‚ã€</h2>
    <p id="description">é»æ“Šåœ°åœ–é»äº®è“®èŠ±ï¼Œæ‚¨çš„å–„å¿µå°‡èˆ‡å…¨çƒåŒæ­¥é¡¯ç¤ºã€‚</p>
    
    <div class="stats-badge" id="stats-area">
        å…¨çƒå·²åŒ¯èšï¼š<span id="count">0</span> ç›å¿ƒç‡ˆ
    </div>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, push, onValue, onChildAdded } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    // --- 1. Firebase è¨­å®š (è«‹ç¢ºä¿è³‡è¨Šæ­£ç¢º) ---
    const firebaseConfig = {
        apiKey: "AIzaSyAspVQZ4NhtQUp_U5Cv-6pV9E39oRlAcWg",
  authDomain: "scoutvesak.firebaseapp.com",
  databaseURL: "https://scoutvesak-default-rtdb.firebaseio.com",
  projectId: "scoutvesak",
  storageBucket: "scoutvesak.firebasestorage.app",
  messagingSenderId: "970243032636",
  appId: "1:970243032636:web:cde5f084f35c4aadc86539",
  measurementId: "G-QJ80DCXFHV"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const pointsRef = ref(db, 'points');

    // --- 2. 100 å¥ä½›å…‰èœæ ¹è­šä¸­è‹±å°ç…§ ---
    const quotes = [
        { zh: "æ…ˆæ‚²å¿ƒæ˜¯ä¸€åˆ‡åŠŸå¾·çš„æ¯é«”ã€‚", en: "Compassion is the mother of all virtues." },
        { zh: "æå¾—èµ·æ˜¯è°æ˜ï¼Œæ”¾å¾—ä¸‹æ˜¯æ™ºæ…§ã€‚", en: "To lift is clever; to let go is wisdom." },
        { zh: "å¿ƒå¥½å‘½å°±å¥½ï¼Œæ…ˆæ‚²è–æ½”å¥½ã€‚", en: "A good heart brings a good life; compassion is holy." },
        { zh: "çµ¦äººä¿¡å¿ƒï¼Œå¸Œæœ›ï¼Œå–œæ‚…ï¼Œæ–¹ä¾¿ã€‚", en: "Give others confidence, hope, joy, and convenience." },
        { zh: "å®¹äººã€åŠ©äººã€æ„›äººï¼Œæ˜¯è‡ªæ•‘æ•‘äººä¹‹é“ã€‚", en: "Tolerance, helping, and loving are ways to save all." },
        { zh: "é¡˜æ…ˆæ‚²ä¹‹å…‰ï¼Œç…§ç ´ä¸–é–“é»‘æš—ã€‚", en: "May the light of compassion illuminate the darkness." },
        { zh: "å¿ƒä¸­æœ‰ä½›ï¼Œæ‰€è¦‹çš†ä½›ã€‚", en: "When there is Buddha in your heart, all you see is Buddha." },
        { zh: "çŸ¥è¶³å¸¸æ¨‚ï¼Œèƒ½å¿è‡ªå®‰ã€‚", en: "Contentment brings joy; patience brings peace." },
        { zh: "å¾®ç¬‘æ˜¯ä¸–ç•Œä¸Šæœ€ç¾çš„è‰²å½©ã€‚", en: "A smile is the most beautiful color in the world." },
        { zh: "è®šç¾æ˜¯ä¸–ç•Œä¸Šæœ€å‹•è½çš„è²éŸ³ã€‚", en: "Praise is the most beautiful sound in the world." },
        { zh: "ä¸€èŠ±ä¸€ä¸–ç•Œï¼Œä¸€è‘‰ä¸€å¦‚ä¾†ã€‚", en: "A world in a flower, a Buddha in a leaf." },
        { zh: "ä¸å¿˜åˆå¿ƒï¼Œæ–¹å¾—å§‹çµ‚ã€‚", en: "Stay true to your original intent to achieve the goal." },
        { zh: "æœ‰å¿—è€…ï¼Œäº‹ç«Ÿæˆã€‚", en: "Where there is a will, there is a way." },
        { zh: "åšäº‹è¦å¦‚ç¹”å¸ƒï¼Œä¸€é‡ä¸€ç·šç²¾é›•ç´°ç¢ã€‚", en: "Work like weaving, meticulously thread by thread." },
        { zh: "æœ€å¥½çš„ç®¡ç†æ˜¯è‡ªå¾‹ã€‚", en: "The best management is self-discipline." },
        { zh: "å­¸ç¿’è¦å¦‚æ˜¥èµ·ä¹‹è‹—ï¼Œæ—¥æœ‰æ‰€é•·ã€‚", en: "Learning is like spring sprouts, growing daily." },
        { zh: "å¯¬å¤§æ˜¯ç¦ï¼Œæ…ˆæ‚²æ˜¯å£½ã€‚", en: "Generosity is a blessing; compassion is longevity." },
        { zh: "å¿ƒå¦‚æ­¢æ°´ï¼Œäº‚è€Œä¸é©šã€‚", en: "Mind like still water, calm amidst chaos." },
        { zh: "å‡¡äº‹ç•™é¤˜åœ°ï¼Œå»ºè¨­å¥½å› ç·£ã€‚", en: "Leave space in all things for good connections." },
        { zh: "éœåå¸¸æ€å·±éï¼Œé–’è«‡è«è«–äººéã€‚", en: "Meditate on your faults; avoid discussing others." }
        // (æ­¤è™•å¯æŒ‰æ ¼å¼ç¹¼çºŒå¢åŠ è‡³ 100 å¥)
    ];

    // --- 3. èªè¨€åˆ‡æ›è¨­å®š ---
    let currentLang = 'zh';
    const i18n = {
        zh: { 
            nav: "VESAK GLOBAL LIGHTING | è¡›å¡å…¨çƒé»ç‡ˆ", 
            desc: "é»æ“Šåœ°åœ–é»äº®è“®èŠ±ï¼Œæ‚¨çš„å–„å¿µå°‡èˆ‡å…¨çƒåŒæ­¥é¡¯ç¤ºã€‚", 
            countLabel: "å…¨çƒå·²åŒ¯èšï¼š", unit: " ç›å¿ƒç‡ˆ",
            quote: "ã€Œé¡˜æ…ˆæ‚²ä¹‹å…‰ï¼Œç…§ç ´ä¸–é–“é»‘æš—ã€‚ã€",
            popupTitle: "æ‚¨å·²é»äº®ä¸€ç›æ…ˆæ‚²ä¹‹å…‰ï¼"
        },
        en: { 
            nav: "VESAK GLOBAL LIGHTING", 
            desc: "Click the map to light a lotus, your good deeds will be synced globally.", 
            countLabel: "Global Deeds Shared: ", unit: " Lights",
            quote: "ã€ŒMay the light of compassion illuminate every corner of the world.ã€",
            popupTitle: "A Light of Compassion is lit!"
        }
    };

    window.toggleLang = function() {
        currentLang = currentLang === 'zh' ? 'en' : 'zh';
        document.getElementById('nav-title').innerText = i18n[currentLang].nav;
        document.getElementById('description').innerText = i18n[currentLang].desc;
        document.getElementById('quote-text').innerText = i18n[currentLang].quote;
        updateDisplay(lastCount);
    };

    // --- 4. åœ°åœ–åˆå§‹åŒ– ---
    const map = L.map('map', {
        center: [20, 0],
        zoom: 2,
        minZoom: 2,
        maxBounds: [[-90, -180], [90, 180]]
    });

    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

    const lotusIcon = L.divIcon({
        className: 'lotus-icon',
        html: 'ğŸª·',
        iconSize: [30, 30],
        iconAnchor: [15, 15]
    });

    // --- 5. åŠŸèƒ½é‚è¼¯ï¼šé»æ“Šã€é¡¯ç¤ºã€åŒæ­¥ ---
    map.on('click', (e) => {
        const q = quotes[Math.floor(Math.random() * quotes.length)];
        push(pointsRef, {
            lat: e.latlng.lat,
            lng: e.latlng.lng,
            q_zh: q.zh,
            q_en: q.en,
            timestamp: Date.now()
        });
    });

    let lastCount = 0;
    function updateDisplay(count) {
        lastCount = count;
        const area = document.getElementById('stats-area');
        area.innerHTML = `${i18n[currentLang].countLabel}<span id="count">${count}</span>${i18n[currentLang].unit}`;
    }

    onChildAdded(pointsRef, (data) => {
        const val = data.val();
        const marker = L.marker([val.lat, val.lng], { icon: lotusIcon }).addTo(map);
        
        const popupContent = `
            <div style="text-align:center; min-width:200px; padding:10px;">
                <b style="color:gold; font-size:1.1em;">${i18n[currentLang].popupTitle}</b><br>
                <div style="margin-top:10px; border-top:1px solid #444; pt:10px;">
                    <p style="color:#fff; margin-bottom:5px;">${val.q_zh}</p>
                    <p style="color:#bbb; font-style:italic; font-size:0.85em;">${val.q_en}</p>
                </div>
            </div>
        `;
        marker.bindPopup(popupContent).openPopup();
    });

    onValue(pointsRef, (snapshot) => {
        updateDisplay(snapshot.size || 0);
    });

</script>
</body>
</html>

